#!/command/with-contenv sh

set -euo pipefail
export BF_E=`basename ${0}`


#======================================================================================================================
# Test setup.
#======================================================================================================================

${BF_LIB}/test-setup
${BF_LIB}/log-starting


#======================================================================================================================
# Restore specified file.
# Arguments:
#   --log-file          Log everything to this file
#   --progress          Show progress during transfer
#======================================================================================================================

${BF_LIB}/clear-restore

bf-echo "Restoring entire mirror..."
rclone copy "${BACKUP_RCLONE_STORAGE}:${BACKUP_RCLONE_PATH}" "${BACKUP_RESTORE}" \
    -v \
    --log-file=${BACKUP_RCLONE_LOG} \
    --progress
bf-done

${BF_LIB}/log-done
